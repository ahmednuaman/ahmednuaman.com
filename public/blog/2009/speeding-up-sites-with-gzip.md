title: Speeding up Sites with GZip
link: http://www.ahmednuaman.com/blog/speeding-up-sites-with-gzip/
creator: ahmed
description: 
post_id: 89
post_date: 2009-05-28 15:18:35
post_date_gmt: 2009-05-28 15:18:35
comment_status: open
post_name: speeding-up-sites-with-gzip
status: publish
post_type: post

# Speeding up Sites with GZip

Web sites need to be fast! Recently I've had some time on my hands so I've done some tests to see which is the best solution. I've had a read about different ways that web sites can be sped up, from compression before you upload files to server side compression. Whenever it comes to speeding things up, I always remember the saying that "loading data from a flat file is slow, a database is slower, but memory is the quickest". So that means if you've using server-side scripting such as PHP or Python, the best thing to do is to use memory caching such as [APC](http://uk.php.net/apc/) or [MemCache](http://www.danga.com/memcached/). Now memory caching is awesome, but as good as it is, some hosting environments don't have it turned on, so what can you do? Well I've put together a list of the ones that I've used on my [portfolio](http://ahmednuaman.com) and blog sites that don't require non-standard configuration settings. **YUI, JSMin and other "before you upload" compression** When you download your copy of jQuery or your favorite framework, it normally comes compressed making it faster to serve. Now there's been lots and lots of articles about which is the best compression utility available and I'm not going to tell you which one to use, but I use [YUI compressor](http://developer.yahoo.com/yui/compressor/) for both JavaScript and CSS. Now a good compressor will compress your code to a ratio of about 30-60%, and that's cool! Here's a [good comparison picker](http://compressorrater.thruhere.net/) tool that'll help you make your decision. Don't forget to compress your CSS and XML as well! **Using Apache's mod_gzip and mod_deflate** This is a nice and handy trick. You basically tell Apache to serve text files (such as XML, JavaScript and CSS) to GZip compress them on-the-fly before they're served to the browser. GZip compression is pretty much the best widely available text compression you can get. So how do you do it? Well simply open up your relative .conf file or .htaccess file and stick the following in there: ` AddOutputFilterByType DEFLATE text/html text/plain text/xml  SetOutputFilter DEFLATE  ` You need to make sure that you have mod_gzip and mod_deflate working on your Apache configuration. But if you haven't got that, then the next one is for you. **Using PHP's Ouput Buffering** PHP has the a great function called "[ob_start()](http://uk3.php.net/ob_start)" that allows you to buffer the output of your contents of your PHP script and make it faster. But there's more, you can set the type of compression you'd like PHP to use. If you pass "[ob_gzhandler](http://uk3.php.net/manual/en/function.ob-gzhandler.php)" as the variable for "ob_start()" it'll use GZip to compress your output. So, to use this, add the following to the top of your PHP file: ` if ( substr_count( $_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip' ) ) { ob_start( 'ob_gzhandler' ); } else { ob_start(); } ` You'll see your file sizes drop! Now you're probably saying that this isn't practical for loading in CSS and JavaScript file, well there's nothing stopping you from creating a proxy: ` if ( substr_count( $_SERVER['HTTP_ACCEPT_ENCODING'], 'gzip' ) ) { ob_start( 'ob_gzhandler' ); } else { ob_start(); } $feed = file_get_contents( $_GET['f'] ); echo $feed; ` You can then simple set up your HTML script code like this: ` ` Now using [FireBug](https://addons.mozilla.org/en-US/firefox/addon/1843) you'll see that the file size has dropped, awesome! So you can now take this and hopefully it'll speed up you web site, and to test, download and install a FireBug extension called [YSlow](http://developer.yahoo.com/yslow/).